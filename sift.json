{
  "name": "sift-pixel-tracker",
  "display-name": "Pixel Tracker",
  "description": "This sift detects emails that are being tracked",
  "author": "Deepak Prabhakara",
  "version": "1.0.0",
  "color": "#842F59",
  "image": "https://static.redsift.io/assets/sifts/sift-pixel-tracker/cctv.jpg",
  "controller": {
    "entry-point": "frontend/controller.js",
    "types": [
      "summary",
      "email-detail"
    ],
    "minimum-size": {
      "width": "compact",
      "height": "compact"
    }
  },
  "client": {
    "entry-point": "frontend/client.js"
  },
  "dag": {
    "inputs": {
      "emails": {
        "trackers": {
          "filter": {
            "conditions": [
              {
                "date": "between now and 1 month before now"
              }
            ],
            "wants": [
                "archive",
                "htmlBody",
                { "feature": "attachments", "parameter": "attachments"}
            ]
          }
        }
      }
    },
    "nodes": [
      {
        "#": "Messages mapper",
        "implementation": {
          "javascript": "server/map.js",
          "qos": {
            "large-storage": ["attachments:ro"]
          }
        },
        "input": {
          "bucket": "trackers"
        },
        "outputs": {
          "idList": {},
          "threads": {}
        }
      },
      {
        "#": "Threads aggregator",
        "implementation": {
          "javascript": "server/threads.js"
        },
        "input": {
          "bucket": "threads",
          "select": "/*"
        },
        "outputs": {
          "tidList": {}
        }
      },
      {
        "#": "Cron test node invalid",
        "implementation": {
          "javascript": "server/cron-invalid.js",
          "when": {
            "interval": 90
          }
        },
        "input": {
          "bucket": "trackers"
        },
        "outputs": {
          "idList": {},
          "threads": {}
        }
      },
      {
        "#": "Cron test node valid",
        "implementation": {
          "javascript": "server/cron.js",
          "when": {
            "crontab": "0 0/1 * 1/1 * ? *"
          }
        },
        "input": {
          "bucket": "threads",
          "select": "/*"
        },
        "outputs": {
          "idList": {},
          "threads": {}
        }
      }
    ],
    "stores": {
      "threads": {
        "key$schema": "string/string"
      }
    },
    "outputs": {
      "exports": {
        "idList": {
          "import": "_id.list"
        },
        "tidList": {
          "import": "_tid.list"
        }
      }
    }
  }
}
