{
  "name": "sift-pixel-tracker",
  "display-name": "Pixel Tracker",
  "description": "This sift detects emails that are being tracked",
  "author": "Deepak Prabhakara",
  "version": "1.0.0",
  "color": "#842F59",
  "image": "https://static.redsift.io/assets/sifts/sift-pixel-tracker/cctv.jpg",
  "interfaces": {
    "email": {
      "thread": {
        "controller": "frontend/controller.js"
      }
    },
    "summary": {
      "controller": "frontend/controller.js"
    }
  },
  "dag": {
    "inputs": {
      "config": {
        "bots": {
          "slack": {
            "clientID": "47738535073.47732460560",
            "ambientMentionDuration": 300,
            "sendIsTyping": true,
            "permission": "team"
          }
        }
      },
      "bots": {
        "slack": {
          "temp": {
            "filter": {
              "conditions": [
                {
                  "type": "message:direct_mention,direct_message,mention,ambient"
                },
                {
                  "text": {
                    "regexp": {
                      "pattern": "temp",
                      "flags": "i"
                    }
                  }
                }
              ],
              "operator": "AND"
            }
          }
        }
      },
      "emails": {
        "trackers": {
          "filter": {
            "conditions": [
              {
                "date": "between now and 1 month before now"
              }
            ],
            "wants": [
              "archive",
              "htmlBody"
            ]
          }
        }
      }
    },
    "nodes": [
      {
        "#": "Temp Slack test",
        "implementation": {
          "javascript": "server/temp.js"
        },
        "input": {
          "bucket": "temp"
        },
        "outputs": {
          "idList": {},
          "threads": {}
        }
      },
      {
        "#": "Messages mapper",
        "implementation": {
          "javascript": "server/map.js"
        },
        "input": {
          "bucket": "trackers"
        },
        "outputs": {
          "idList": {},
          "threads": {}
        }
      },
      {
        "#": "Threads aggregator",
        "implementation": {
          "javascript": "server/threads.js"
        },
        "input": {
          "bucket": "threads",
          "select": "/*"
        },
        "outputs": {
          "tidList": {}
        }
      },
      {
        "#": "Cron test node invalid",
        "implementation": {
          "javascript": "server/cron-invalid.js",
          "when": {
            "interval": 90
          }
        },
        "input": {
          "bucket": "trackers"
        },
        "outputs": {
          "idList": {},
          "threads": {}
        }
      },
      {
        "#": "Cron test node valid",
        "implementation": {
          "javascript": "server/cron.js",
          "when": {
            "crontab": "0 0/1 * 1/1 * ? *"
          }
        },
        "input": {
          "bucket": "threads",
          "select": "/*"
        },
        "outputs": {
          "idList": {},
          "threads": {}
        }
      }
    ],
    "stores": {
      "threads": {
        "key$schema": "string/string"
      }
    },
    "outputs": {
      "exports": {
        "idList": {
          "import": "_email.id"
        },
        "tidList": {
          "import": "_email.tid"
        }
      }
    }
  }
}